<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <style>
      body {
        margin: auto;
      }
      #progress-container {
        width: 1200px;
        height: 1200px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-110%, -50%);
      }

      #progress-svg {
        width: 100%;
        height: 100%;
      }

      #progress-circle {
        fill: none;
        stroke: url(#image-pattern);
        stroke-width: 110;
        stroke-linecap: butt;
        stroke-dasharray: 1650;
        stroke-dashoffset: -100;
        transform-origin: center;
        transform: rotate(0deg);
      }
    </style>
  </head>
  <body>
    <div id="progress-container">
      <svg id="progress-svg" viewBox="0 0 1000 1000">
        <defs>
          <pattern
            id="image-pattern"
            patternUnits="userSpaceOnUse"
            height="100%"
            width="200%"
          >
            <image
              width="100%"
              height="100%"
              xlink:href="https://png.pngtree.com/background/20211217/original/pngtree-abstract-bg-picture-image_1596862.jpg"
            ></image>
          </pattern>
        </defs>
        <circle id="progress-circle" cx="500" cy="500" r="230"></circle>
      </svg>
    </div>

    <script>
      function animateProgressCircle() {
        const progressCircle = document.getElementById("progress-circle");
        const circumference = progressCircle.getTotalLength();

        progressCircle.style.strokeDasharray = circumference;
        progressCircle.style.strokeDashoffset = circumference;

        gsap.to(progressCircle, {
          strokeDashoffset: 0,
          duration: 2,
          ease: "power2.inOut",
        });
      }

      gsap.registerPlugin(ScrollTrigger);
      if (gsap && gsap.registerPlugin && ScrollTrigger) {
        ScrollTrigger.create({
          markers: true,
          start: "top 80%",
          end: "top 55%",
          immediateRender: false,
          trigger: "body",
          onEnter: () => {
            animateProgressCircle();
          },
        });
      } else {
        console.log("GSAP or ScrollTrigger not loaded.");
      }
    </script>
  </body>
</html>
